<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commandement BiomeVivants - Jeu de Strat√©gie</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse-animation { animation: pulse 2s infinite; }

        body {
            background: linear-gradient(to bottom, #061010, #001414);
            min-height: 100vh;
        }
    </style>
</head>
<body class="text-white">
    <div id="app" class="max-w-4xl mx-auto p-4"></div>

    <script>
        // =======================
        // CONSTANTES DE JEU
        // =======================
        const GAME_CONFIG = {
            PRODUCTION_RATES: {
                CRYSTAL_PER_EXTRACTOR: 10,
                ESSENCE_PER_EXTRACTOR: 5,
                ENERGY_PER_CORE: 50,
                STORAGE_PER_HUB: 5000
            },
            MAX_QUEUE: 5,
            AUTOSAVE_INTERVAL: 10000,
            TICK_RATE: 1000
        };

        const BUILDINGS = {
            extractor: {
                label: 'Extracteur Cristallin',
                desc: 'R√©cup√®re cristaux et essences',
                cost: (level) => ({
                    crystal: Math.floor(60 * Math.pow(1.5, level)),
                    essence: Math.floor(30 * Math.pow(1.5, level)),
                    energy: 0
                }),
                time: 30,
                icon: '‚õèÔ∏è'
            },
            core: {
                label: 'Noyau d‚Äô√ânergie',
                desc: 'Produit l‚Äô√©nergie n√©cessaire',
                cost: (level) => ({
                    crystal: Math.floor(75 * Math.pow(1.5, level)),
                    essence: Math.floor(50 * Math.pow(1.5, level)),
                    energy: 0
                }),
                time: 40,
                icon: '‚ö°'
            },
            hub: {
                label: 'Hub de Stockage',
                desc: 'Augmente la capacit√© de ressources',
                cost: (level) => ({
                    crystal: Math.floor(100 * Math.pow(1.4, level)),
                    essence: Math.floor(80 * Math.pow(1.4, level)),
                    energy: 10
                }),
                time: 25,
                icon: 'üì¶'
            },
            nursery: {
                label: 'Nurserie',
                desc: 'Forme des unit√©s biologiques',
                cost: () => ({ crystal: 200, essence: 150, energy: 30 }),
                time: 35,
                icon: 'ü™¥'
            },
            portal: {
                label: 'Portail de Migration',
                desc: 'Construit des unit√©s volantes',
                cost: () => ({ crystal: 400, essence: 200, energy: 50 }),
                time: 60,
                icon: 'üåå'
            },
            lab: {
                label: 'Laboratoire d‚Äô√âvolution',
                desc: 'Am√©liore les technologies biologiques',
                cost: () => ({ crystal: 300, essence: 300, energy: 100 }),
                time: 50,
                icon: 'üî¨'
            }
        };

        const UNITS = {
            spores: {
                label: 'Spores Guerri√®res',
                cost: { crystal: 20, essence: 10, energy: 5 },
                time: 10,
                requires: 'nursery',
                power: 1,
                icon: 'üçÉ'
            },
            flyers: {
                label: 'Ailes Cristallines',
                cost: { crystal: 100, essence: 80, energy: 30 },
                time: 30,
                requires: 'portal',
                power: 5,
                icon: 'ü¶ã'
            },
            leviathans: {
                label: 'Leviathans',
                cost: { crystal: 500, essence: 400, energy: 200 },
                time: 90,
                requires: 'portal',
                power: 20,
                icon: 'üêâ'
            }
        };

        const TECHNOLOGIES = {
            vigor: {
                label: 'Vigueur Biologique',
                desc: '+10% d√©g√¢ts par niveau',
                cost: (level) => ({
                    crystal: Math.floor(200 * Math.pow(1.8, level)),
                    essence: Math.floor(200 * Math.pow(1.8, level)),
                    energy: 100 * level
                }),
                time: 60,
                icon: '‚öîÔ∏è'
            },
            shield: {
                label: 'Carapace Protectrice',
                desc: '+10% r√©sistance par niveau',
                cost: (level) => ({
                    crystal: Math.floor(300 * Math.pow(1.8, level)),
                    essence: Math.floor(150 * Math.pow(1.8, level)),
                    energy: 150 * level
                }),
                time: 70,
                icon: 'üõ°Ô∏è'
            },
            metabolism: {
                label: 'M√©tabolisme Optimis√©',
                desc: '+10% production extracteurs',
                cost: (level) => ({
                    crystal: Math.floor(150 * Math.pow(1.6, level)),
                    essence: Math.floor(150 * Math.pow(1.6, level)),
                    energy: 80 * level
                }),
                time: 50,
                icon: '‚öôÔ∏è'
            }
        };

        const MISSIONS = [
            {
                id: 'scout',
                label: 'Patrouille Biome',
                desc: 'Explorer les alentours',
                requirements: { spores: 5 },
                duration: 30,
                rewards: { crystal: 100, essence: 50, reputation: 5 },
                risk: 0.1,
                icon: 'üîç'
            },
            {
                id: 'recon',
                label: 'Reconnaissance Biome',
                desc: '√âtudier un territoire inconnu',
                requirements: { spores: 15, flyers: 1 },
                duration: 60,
                rewards: { crystal: 250, essence: 150, reputation: 15 },
                risk: 0.25,
                icon: 'üéØ'
            },
            {
                id: 'defense',
                label: 'D√©fense du Nexus',
                desc: 'Prot√©ger le biome',
                requirements: { spores: 30, flyers: 3, leviathans: 1 },
                duration: 90,
                rewards: { crystal: 600, essence: 400, reputation: 30 },
                risk: 0.35,
                icon: 'üõ°Ô∏è'
            }
        ];

        // =======================
        // √âTAT DU JEU
        // =======================
        class GameState {
            constructor() {
                this.load();
            }

            getInitialState() {
                return {
                    resources: { crystal: 500, essence: 300, energy: 1000 },
                    buildings: { extractor: 1, core: 1, hub: 1, nursery: 0, portal: 0, lab: 0 },
                    military: { spores: 10, flyers: 0, leviathans: 0 },
                    technology: { vigor: 1, shield: 1, metabolism: 1 },
                    buildQueue: [],
                    activeMissions: [],
                    messages: ['Bienvenue, Commandant. Nexus √©tabli.'],
                    reputation: 0,
                    completedMissions: 0,
                    time: 0,
                    activeTab: 'overview'
                };
            }

            load() {
                const saved = localStorage.getItem('biomeGame');
                if (saved) {
                    Object.assign(this, JSON.parse(saved));
                } else {
                    Object.assign(this, this.getInitialState());
                }
            }

            save() {
                localStorage.setItem('biomeGame', JSON.stringify(this));
            }

            reset() {
                if (confirm('R√©initialiser le jeu ?')) {
                    localStorage.removeItem('biomeGame');
                    Object.assign(this, this.getInitialState());
                    this.addMessage('Jeu r√©initialis√©.');
                }
            }

            addMessage(msg) {
                this.messages = [...this.messages.slice(-4), msg];
            }

            formatNumber(num) {
                if (num >= 1000000) return `${(num/1000000).toFixed(1
